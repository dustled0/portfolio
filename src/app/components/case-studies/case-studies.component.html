<section id="case-studies" class="section" aria-labelledby="case-studies-title">
  <div class="container">
    <h2 id="case-studies-title" class="section__title" appScrollReveal>Case Studies</h2>
    <p class="section__subtitle" appScrollReveal [delay]="50">Real problems. Real solutions. Real results.</p>

    <div class="case-studies">
      @for (study of caseStudies; track study.title; let i = $index) {
        <article class="case-study" [class.case-study--expanded]="isExpanded(i)" appScrollReveal [delay]="i * 150">
          <div class="case-study__header" (click)="toggleExpand(i)">
            <div class="case-study__meta">
              <span class="case-study__industry">
                <i class="fas fa-industry" aria-hidden="true"></i>
                {{ study.industry }}
              </span>
              <span class="case-study__duration">
                <i class="fas fa-clock" aria-hidden="true"></i>
                {{ study.duration }}
              </span>
            </div>
            <h3 class="case-study__title">{{ study.title }}</h3>
            <p class="case-study__client">
              <i class="fas fa-building" aria-hidden="true"></i>
              {{ study.client }}
            </p>
            <button class="case-study__toggle" [attr.aria-expanded]="isExpanded(i)">
              <span>{{ isExpanded(i) ? 'Show less' : 'Read full case study' }}</span>
              <i class="fas" [class.fa-chevron-up]="isExpanded(i)" [class.fa-chevron-down]="!isExpanded(i)" aria-hidden="true"></i>
            </button>
          </div>

          <div class="case-study__content" [class.case-study__content--visible]="isExpanded(i)">
            <div class="case-study__section">
              <h4 class="case-study__section-title">
                <i class="fas fa-exclamation-circle" aria-hidden="true"></i>
                The Problem
              </h4>
              <p>{{ study.problem }}</p>
            </div>

            <div class="case-study__section">
              <h4 class="case-study__section-title">
                <i class="fas fa-lightbulb" aria-hidden="true"></i>
                The Solution
              </h4>
              <p>{{ study.solution }}</p>
            </div>

            <div class="case-study__section">
              <h4 class="case-study__section-title">
                <i class="fas fa-chart-line" aria-hidden="true"></i>
                Results
              </h4>
              <ul class="case-study__results">
                @for (result of study.results; track result) {
                  <li>
                    <i class="fas fa-check-circle" aria-hidden="true"></i>
                    {{ result }}
                  </li>
                }
              </ul>
            </div>

            @if (study.metrics && study.metrics.length > 0) {
              <div class="case-study__metrics">
                @for (metric of study.metrics; track metric.label) {
                  <div class="case-study__metric">
                    <span class="case-study__metric-value">{{ metric.value }}</span>
                    <span class="case-study__metric-label">{{ metric.label }}</span>
                    @if (metric.improvement) {
                      <span class="case-study__metric-improvement">{{ metric.improvement }}</span>
                    }
                  </div>
                }
              </div>
            }

            <div class="case-study__technologies">
              <h4 class="case-study__section-title">
                <i class="fas fa-tools" aria-hidden="true"></i>
                Technologies Used
              </h4>
              <div class="case-study__tech-tags">
                @for (tech of study.technologies; track tech) {
                  <span class="tag">{{ tech }}</span>
                }
              </div>
            </div>

            @if (study.testimonial) {
              <blockquote class="case-study__testimonial">
                <p>"{{ study.testimonial.quote }}"</p>
                <footer>
                  <strong>{{ study.testimonial.author }}</strong>
                  <span>{{ study.testimonial.position }}</span>
                </footer>
              </blockquote>
            }
          </div>
        </article>
      }
    </div>
  </div>
</section>
